<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>패스비 · 마이페이지</title>
  <!-- 경로는 프로젝트 구조에 맞게 수정 -->
  <link rel="stylesheet" href="../css_vscode/mypage.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <div class="container">
    <!-- ===== 왼쪽 사이드바 ===== -->
    <aside class="sidebar">
      <div class="sidebar-inner">
        <div class="sb-logo">패스비</div>

        <h2 class="sb-title">마이페이지</h2>
        <p class="sb-sub">원하는 정보를 확인하세요.</p>

        <!-- 3 + 2 버튼 그리드 -->
        <div class="sb-actions">
          <button class="sb-btn"><span class="stack">캘린더</span></button>
          <button class="sb-btn"><span class="stack">관심<br>자격증</span></button>
          <button class="sb-btn"><span class="stack">회원정보<br>수정</span></button>

          <!-- 아래 줄: 좌/우 배치 (가운데 비움) -->
          <button class="sb-btn place-left"><span class="stack">원서접수<br>내역</span></button>
          <button class="sb-btn place-right"><span class="stack">회원탈퇴</span></button>
        </div>

        <div class="sb-links">
          <a href="#">Q&amp;A</a>
          <a href="#">문의하기</a>
          <a href="#">전달환경</a>
        </div>
      </div>
    </aside>

    <!-- ===== 메인 콘텐츠 ===== -->
    <main class="main-content">
      <!-- 상단: 검색(펼침형) + 로그인/회원가입 -->
      <div class="top-bar">
        <nav class="top-actions">
          <!-- 아이콘만 보이다가 hover/focus 시 왼쪽으로 펼쳐짐 -->
          <form class="search" role="search" onsubmit="return handleSearch(event)">
            <button class="icon" type="submit" aria-label="검색">
              <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
                <circle cx="11" cy="11" r="7" fill="none" stroke="currentColor" stroke-width="2"/>
                <line x1="16.65" y1="16.65" x2="21" y2="21"
                      stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </button>
            <input type="search" name="q" placeholder="검색어를 입력하세요" autocomplete="off" />
          </form>

          <div class="auth-buttons">
            <button>로그인</button>
            <button>회원가입</button>
          </div>
        </nav>
      </div>

      <!-- 다가오는 시험 + 달력 -->
      <section class="exam-calendar-section">
        <div class="upcoming-exam">
          <h3>다가오는 시험</h3>
          <ul id="examList">
            <!-- TODO: 백엔드 연동 시 fetch()로 대체 -->
            <li><strong>2025-09-22</strong> - 정보처리기사</li>
            <li><strong>2025-09-25</strong> - SQLD</li>
          </ul>
        </div>

        <div class="calendar-box">
          <h3 id="calendarTitle">달력</h3>
          <table class="calendar">
            <thead>
              <tr>
                <th>일</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th>
              </tr>
            </thead>
            <tbody id="calendarBody">
              <!-- JS가 자동으로 채움 -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- 정보 박스들 -->
      <section class="info-section">
        <div class="info-box">
          <h3>관심자격증</h3>
          <ul>
            <li>⭐ 정보처리기사</li>
            <li>⭐ SQLD</li>
            <li>⭐ JLPT</li>
          </ul>
        </div>

        <div class="info-box">
          <h3>저장한 자료</h3>
        </div>

        <div class="info-box">
          <h3>원서접수 내역</h3>
        </div>
      </section>
    </main>
  </div>

  <!-- ===== 스크립트: 달력 + 검색 제출 ===== -->
  <script>
    // 달력 자동 생성
    const calendarBody  = document.getElementById("calendarBody");
    const calendarTitle = document.getElementById("calendarTitle");

    const now    = new Date();
    const cYear  = now.getFullYear();
    const cMonth = now.getMonth(); // 0 = Jan

    calendarTitle.textContent = `${cYear}년 ${cMonth + 1}월`;

    const firstDay = new Date(cYear, cMonth, 1).getDay();
    const lastDate = new Date(cYear, cMonth + 1, 0).getDate();

    // 예시 시험(2025년 9월)
    // TODO: 백엔드 연동 시 이 배열 대신 fetch()로 가져오기
    const examMarks = [];
    if (cYear === 2025 && cMonth === 8) { // 8 = 9월
      examMarks.push({ day: 22, title: "정보처리기사" });
      examMarks.push({ day: 25, title: "SQLD" });
    }

    let html = "<tr>";
    let count = 0;

    for (let i = 0; i < firstDay; i++) { html += "<td></td>"; count++; }

    for (let d = 1; d <= lastDate; d++) {
      let cls = "";
      if (d === now.getDate() && cYear === now.getFullYear() && cMonth === now.getMonth()) cls = "today";
      if (examMarks.some(x => x.day === d)) cls = "exam-date";

      html += `<td class="${cls}">${d}</td>`;
      count++;
      if (count % 7 === 0 && d !== lastDate) html += "</tr><tr>";
    }
    html += "</tr>";
    calendarBody.innerHTML = html;

    // 검색 제출
    function handleSearch(e){
      e.preventDefault();
      const q = e.currentTarget.q.value.trim();
      if(!q){
        alert("검색어를 입력하세요.");
        return false;
      }
      // TODO: 실제 검색 로직 (페이지 이동/검색 API)
      // location.href = `/search?q=${encodeURIComponent(q)}`;
      return false;
    }
  </script>
</body>
</html>
